---
- apt: name="ntp,openssl,libcurl4" state=present update_cache=True
- file: path={{ jobclient_home }} state=directory
- copy: src={{ jobclient_snarkos_path }} dest={{ jobclient_home }}/snarkos_mine mode=u=rwx,g=rx,o=rx
- name: "test snarkos mineblock command"
  command: "{{ jobclient_home }}/snarkos_mine mineblock '{\"previous_block_hash\":\"ab1e8nppz4jsfx7ruyppyuvmk990q0cul378xq6p00zwlm44csdpg9qqhjvw3\",\"block_height\":132797,\"block_timestamp\":1641508828,\"difficulty_target\":1000053761437857132,\"cumulative_weight\":39877618144,\"previous_ledger_root\":\"al1gawc2clle364e3c59h0l3vrwe4tc0sf7k4hxpq6yesk3tet3pqqs0pywux\",\"transactions\":{\"transactions\":[{\"transaction_id\":\"at1vkasaf7y79ezswvglg8732t2cs4ch42747vuvx499rtgwag6jvpqxzsvn5\",\"inner_circuit_id\":\"ic13cstkmt5j4qqzfu5am8jx2rhxm0hqplyzcgzyueefz7n32xl4h53n4xmxvhjyzaq2c0f7l70a4xszau2ryc\",\"ledger_root\":\"al1enk2kwh9nuzcj2q9kdutekavlf8ayjqcuszgezsfax8qxn9k0yxqfr9fr2\",\"transitions\":[{\"transition_id\":\"as1e7z3lnff5wk2vh43l2dl7elgv4k95rftwlw0e63dg4xl8ekp7yqqgmkdwz\",\"serial_numbers\":[\"sn1m3ly9sry9l8jq9usssu6d3lln7raesurgad746afje846n8f0vpq5rdjff\",\"sn1ky5g6qy9fd6n0z0mgxljr9l0wjk2k4u9uwlwyyzrmk5qesn2csgsfyl87l\"],\"commitments\":[\"cm127v5mjg8wtrjnk8shq75njej5zzkwhzk2n8t7l5a8ln8jvugnsysd7cx32\",\"cm1744yzd3d24cnapl5r0k3cqesypz75wf09e2yuvczs80lh4lqrvps6uu2wy\"],\"ciphertexts\":[\"recd1q403huz648fdj42gzwmaeyh7csfzj6m5jn7xezec43ypfjujgvzrlnnprcv2jgtudq20ra6ufsqv3ffmhte0jnns039m4498xrdtzyz82chkrc532jqqa6jmsx7g76g7frk04w4frh9wsv2xwneefjjep92nfzs9k05sushl4jjna6mxj2834nsr26spdvke8ulwvu4eggnq3j68ef8kfsxfsayswk6pqnwj5m9ec3ztjsz629xrp95udxepvws8md2qyulferlhcflcjt5jdydew77kgth5vldcasjqehjxtt2uev82dt8a9w94vwqrnx7amhrj9q4vhnzevew48auc3e325zn7magxuptetvhmnkqjgmn8g3w3kw5er6fv7ful30kcxk350s54c7vadx25pzzmnd0mg6mhdzzdh77vdmf7xg65rasd30kue7pt0fvav2gp73fssnszncx\",\"recd1vy9dtn5juaykp4svw5shq06h6vfnuhyrp0wjcgyzgxz95q930vz0j28zklk5td8650005juufm2vwq630cyuuqhtjjex2gqcxxsv5q6r7frm7d9vvjv94930uyh8lmq3k30e6tvxz5dsluq6f2svez3sq754r7xjptxya02yshe59fhnyw5apx57duuw2f9zle6tz3u0lu3qg6z250n3j8wztv864n3hktc5zp5e0akau8q37qwtgsewyu5ayecrmz6d92gav2rhcchq4xg4eq2gmyzw7qjq2qn3gmfswgu0e2rqauyjktcs5cxrm9xmjfwe0v5drhvrrd82wgfryfw47ayzxaz4xqsz6yx8328k9x5q3fgs4v3t9v4ut0d58g0z7t2yn90u5hw2ca2lsk3eqcpy6pj28fp36fauyuh8pq2lp7vu3kqt9r99amdjuppw45lqwgnqw96tlsu\"],\"value_balance\":-100000000,\"events\":[{\"id\":1,\"index\":0,\"record_view_key\":\"rcvk17seudezu7al0uet7frxs05zz56c9hk9hu84t58uy6phfaa82l5ps60y4cv\"},{\"id\":1,\"index\":1,\"record_view_key\":\"rcvk1p8g4ksdafdz2tazyg3n5rj6xdfs87yp64f59k3cxxvsnztnp55pqvahtt8\"}],\"proof\":\"ozkp1ju4rl5mc3406a4m4ksfgfzwr8nwp8a7d7krd5g6emst57nukm0gmlwd0spls0e3uk2259re047lgup63gs3j956kgfc9kwjxtnh8nl8qxyfpexqe0yunegtd4txyka8hwe0598sz7tzx69khqu4nt5tlqr4gqmxa2qnkdes6xty6uu2kz75je7qx9dlcxs7lg4mcf0hctvvhmt4hqd0swl2j9pxmmykjyp2dq8rx2uv3fhxxp3uwmzjx8pu2r8u3xflsrdcmrtz72namhv80mrltk6t23engucfudjldgeycc0dhyuq8agzyh2ruv0qf7dja98eevnkgfen3h8t2lrlsj9446jf43vjj2y2xyed5elphruhrdfcnhha782cnrseuq0m48rfm4p2xrwzfj0zxmggmv8hfrtcjmex44g0u5gmx3h7r60xmsdqvrqvepsj39jqjc8aqqqgjfsepy\"}]}]},\"coinbase_record\":{\"owner\":\"aleo18c7f54vnpq5ew63fn002n7jczl3xpv2yg2znucdr6w6ccl2c3qps7ej54a\",\"value\":100000000,\"payload\":\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"program_id\":\"ap1lhj3g5uzervu3km7rl0rsd0u5j6pj9ujum6yxrvms4mx8r2qhew88ga849hnjypghswxceh02frszs45qmd\",\"randomizer\":\"rr1q403huz648fdj42gzwmaeyh7csfzj6m5jn7xezec43ypfjujgvzqg8cj64\",\"record_view_key\":\"rcvk17seudezu7al0uet7frxs05zz56c9hk9hu84t58uy6phfaa82l5ps60y4cv\",\"commitment\":\"cm127v5mjg8wtrjnk8shq75njej5zzkwhzk2n8t7l5a8ln8jvugnsysd7cx32\"}}'"
  args:
    creates: "{{ ansible_env.HOME }}/.aleo/resources/posw.proving.b2d14c7"
  no_log: true
- copy: src={{ jobclient_script_path }} dest={{ jobclient_home }}/{{ jobclient_script }} mode=u=rwx,g=rx,o=rx
  notify: "restart jobclient"
- template: src=jobclient.service.j2 dest=/etc/systemd/system/jobclient.service
  notify: "restart jobclient"

